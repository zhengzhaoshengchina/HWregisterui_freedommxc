define("base/utils/CbcHttpService",["language/resource","base/utils/cookie","base/utils/iamHttpService","base/utils/pageUtil","base/js/GData"],function(i18n,cookieOp,iamHttpService,pageUtil,GData){function checkIdentity($scope,idType,idValue,callback_success,callback_fail,isAsync){window.hwcap&&window.hwcap.reload();iamHttpService.post({"url":"/registerui/rest/cbc/cbccustomerregservice/v1/account/check_identity","async":!!isAsync,"contentType":"application/json; charset=UTF-8","params":JSON.stringify({"identityType":idType,"identityValue":trimInput(idValue),"scenceType":$scope.model.sceneType,"accountType":$scope&&$scope.isUniRegister?"UNIPORTAL":"","areaCode":$scope.model.regionId||GData.CONFIG.DEFAULT_REGION,"externalSiteCode":$scope.model.externalSiteCode?$scope.model.externalSiteCode:"","clientInfo":{"devId":cookieOp.get_cookie("cbc-sid"),"hwMeta":$("#hwmeta").val()||""}})}).then(function(data){callback_success&&callback_success(data)},function(data){callback_fail&&callback_fail(data)})}return{"getCurrentIpinfo":function($scope){var ipInfo;$.ajax({"type":"GET","url":"https://portal-intl.huaweicloud.com/portaluserqueryservice/ipsearch","async":!1,"success":function(data){ipInfo=data;$scope.model.currentRegion=data&&data.data&&data.data[0]&&data.data[0].location&&data.data[0].location.countrycode;currentRegion=$scope.model.currentRegion},"error":function(err){}});return ipInfo},"getRegionList":function($scope,callback_success,callback_fail){this.getCurrentIpinfo($scope);$scope.model.regionValues=[];$scope.model.countryCodeOptions=[];iamHttpService.get({"url":"/registerui/rest/cbc/cbcconfigcenterservice/v1/datadictionary/query-country","data":{"pageNo":-1,"pageSize":-1,"lang":window.language,"orderType":"customer"},"async":!1}).then(function(data){var temp,regions,i,tempCode,currentRegion;$scope.model.regionJson={};regions=data.countryList&&data.countryList.length>0?data.countryList:GData.CONFIG.DEFAULT_COUNTRY_LIST;regions=removeProperty(regions);for(i in regions)if("normal"===regions[i].status){$scope.model.regionJson[regions[i].countryAbbreviation]=regions[i].countryName;temp={"id":regions[i].countryAbbreviation,"label":regions[i].countryName};$scope.model.regionValues.push(temp);tempCode={"id":regions[i].countryCode,"label":regions[i].countryCode,"actualValue":regions[i].countryName};$scope.model.countryCodeOptions.push(tempCode)}currentRegion=$scope.model.currentRegion;if($scope.model.regionValues)if($scope.model.regionJson[currentRegion]){$scope.model.regionId=currentRegion;$scope.model.regionName=$scope.model.regionJson[currentRegion]}else if(GData.CONFIG.DEFAULT_REGION&&$scope.model.regionJson[GData.CONFIG.DEFAULT_REGION]){$scope.model.regionId=GData.CONFIG.DEFAULT_REGION;$scope.model.regionName=$scope.model.regionJson[GData.CONFIG.DEFAULT_REGION]}else{$scope.model.regionId=$scope.model.regionValues[0].id;$scope.model.regionName=$scope.model.regionValues[0].label}callback_success&&callback_success(data)},function(data){var i,regions=GData.CONFIG.DEFAULT_COUNTRY_LIST;$scope.model.regionJson={};for(i in regions){if(!regions[i]||!regions[i].countryAbbreviation)continue;$scope.model.regionJson[regions[i].countryAbbreviation]=regions[i].countryName;$scope.model.regionValues.push({"id":regions[0].countryAbbreviation,"label":regions[i].countryName});$scope.model.countryCodeOptions.push({"id":regions[0].countryCode,"label":regions[0].countryCode,"actualValue":"Hong Kong"})}$scope.model.regionId=GData.CONFIG.DEFAULT_REGION;$scope.model.regionName=$scope.model.regionJson[GData.CONFIG.DEFAULT_REGION];callback_fail&&callback_fail(data)})},"getCurrentIpinfoV2":function($scope,callback_success){var ipInfo;$.ajax({"type":"GET","url":"https://portal-intl.huaweicloud.com/portaluserqueryservice/ipsearch","success":function(data){ipInfo=data;$scope.model.currentRegion=data&&data.data&&data.data[0]&&data.data[0].location&&data.data[0].location.countrycode;currentRegion=$scope.model.currentRegion;$scope.getCurrentIpinfoRsp=!0;callback_success&&callback_success($scope)},"error":function(err){$scope.getCurrentIpinfoRsp=!0}});return ipInfo},"getRegionListV2":function($scope,callback_success,callback_fail){this.getCurrentIpinfoV2($scope,callback_success);$scope.model.regionValues=[];$scope.model.countryCodeOptions=[];iamHttpService.get({"url":"/registerui/rest/cbc/cbcconfigcenterservice/v1/datadictionary/query-country","data":{"pageNo":-1,"pageSize":-1,"lang":window.language,"orderType":"customer"},"async":!0}).then(function(data){var temp,regions,i,tempCode,currentRegion;$scope.model.regionJson={};regions=data.countryList&&data.countryList.length>0?data.countryList:GData.CONFIG.DEFAULT_COUNTRY_LIST;regions=removeProperty(regions);for(i in regions)if("normal"===regions[i].status){$scope.model.regionJson[regions[i].countryAbbreviation]=regions[i].countryName;temp={"id":regions[i].countryAbbreviation,"label":regions[i].countryName};$scope.model.regionValues.push(temp);tempCode={"id":regions[i].countryCode,"label":regions[i].countryCode,"actualValue":regions[i].countryName};$scope.model.countryCodeOptions.push(tempCode)}currentRegion=$scope.model.currentRegion;if($scope.model.regionValues)if($scope.model.regionJson[currentRegion]){$scope.model.regionId=currentRegion;$scope.model.regionName=$scope.model.regionJson[currentRegion]}else if(GData.CONFIG.DEFAULT_REGION&&$scope.model.regionJson[GData.CONFIG.DEFAULT_REGION]){$scope.model.regionId=GData.CONFIG.DEFAULT_REGION;$scope.model.regionName=$scope.model.regionJson[GData.CONFIG.DEFAULT_REGION]}else{$scope.model.regionId=$scope.model.regionValues[0].id;$scope.model.regionName=$scope.model.regionValues[0].label}$scope.getRegionListRsp=!0;callback_success&&callback_success(data)},function(data){var i,regions=GData.CONFIG.DEFAULT_COUNTRY_LIST;$scope.model.regionJson={};for(i in regions){if(!regions[i]||!regions[i].countryAbbreviation)continue;$scope.model.regionJson[regions[i].countryAbbreviation]=regions[i].countryName;$scope.model.regionValues.push({"id":regions[0].countryAbbreviation,"label":regions[i].countryName});$scope.model.countryCodeOptions.push({"id":regions[0].countryCode,"label":regions[0].countryCode,"actualValue":"Hong Kong"})}$scope.model.regionId=GData.CONFIG.DEFAULT_REGION;$scope.model.regionName=$scope.model.regionJson[GData.CONFIG.DEFAULT_REGION];callback_fail&&callback_fail(data)})},"initGeeTest":function($scope){$scope.model.captchaType=GData.CONST.BOT_CHECK_TYPE_GRAPHIC;var handler1=function(captchaObj){captchaObj.onReady(function(){$scope.model.captchaType=GData.CONST.BOT_CHECK_TYPE_GEETEST}).onSuccess(function(){var result=captchaObj.getValidate();$scope.model.geetestChallenge=result.geetest_challenge;$scope.model.geetestValidate=result.geetest_validate;$scope.model.geetestSeccode=result.geetest_seccode;$scope.geetestPassCallback()}).onError(function(){onGeetestCloudBi(600);$scope.geetestFailCallback()}).onClose(function(){$scope.geetestFailCallback()});$scope.model.captchaObj=captchaObj};iamHttpService.post({"url":"/registerui/rest/cbc/cbccustomerregservice/v1/util/geetest/init","contentType":"application/json; charset=utf-8","dataType":"json","params":JSON.stringify({"clientType":$scope.model.clientType})}).then(function(data){$scope.model.sessionId=data.sessionId;initGeetest({"gt":data.geeTestInfo.gt,"challenge":data.geeTestInfo.challenge,"new_captcha":data.new_captcha,"offline":!1,"product":"bind","pure":1,"lang":window.language,"hideSuccess":"zh-cn"!=window.language,"width":"100%"},handler1);onGeetestInit("success",$scope.model.sessionId)},function(err){$scope.model.sessionId=err&&err.responseJSON&&err.responseJSON.sessionId;onGeetestInit("fail",$scope.model.sessionId)})},"checkNameExist":function($scope,isSubmit){var exist=!1;checkIdentity($scope,GData.CONST.IDENTIFY_TYPE_NAME,$scope.model.accountName,function(data){if(data)if("true"===data.canUse){exist=!1;1!==isSubmit&&onAccountCloudBi()}else{$scope.showMessage(i18n("registerErrorTip8"));exist=!0;1!==isSubmit&&onAccountCloudBi(2)}else exist=!1;pageUtil.setInvalid("#accountInput",exist)},function(err){exist=!1;1!==isSubmit&&onAccountCloudBi();pageUtil.setInvalid("#accountInput",exist)})},"checkEmailExist":function($scope,isSubmit){var exist=!1;checkIdentity($scope,GData.CONST.IDENTIFY_TYPE_EMAIL,$scope.model.email,function(data){if(data){if("true"===data.canUse){exist=!1;1!==isSubmit&&onEmailCloudBi()}else{$scope.showMessage(i18n("registerFailed.emailRepeat"));exist=!0;1!==isSubmit&&onEmailCloudBi(2)}"CBC.7367"===data.error_code&&($scope.model.isInIpWhiteList=!0)}else exist=!1;pageUtil.setInvalid("#emailInput",exist)},function(err){var msgMap,error_code,msg;exist=!1;msgMap={"CBC.7239":i18n("emailValid"),"CBC.7250":i18n("mobileValid")};error_code=err&&err.responseJSON&&err.responseJSON.error_code;msg=msgMap[error_code];msg&&$scope.showMessage(msg);if($.inArray(error_code,["CBC.7239"])>-1){exist=!0;1!==isSubmit&&onEmailCloudBi(2)}else 1!==isSubmit&&onEmailCloudBi();pageUtil.setInvalid("#emailInput",exist)},!isSubmit);return exist},"checkPhoneInvalid":function($scope,isSubmit,callback){var exist=!1;checkIdentity($scope,GData.CONST.IDENTIFY_TYPE_PHONE,$scope.model.callingCode+"-"+$scope.model.phone,function(data){var btnGoEnroll,btnCancelEnroll;if(data){$scope.model.showPhoneRepeat="true"===data.identityUsed;$scope.model.canPhoneUse=!0;if(1==isSubmit&&$scope.model.isMkRegister){if($scope.model.showPhoneRepeat){if("true"!==data.canUse){exist=!0;$scope.model.canPhoneUse=!1;pageUtil.setInvalid("#phoneInput",exist);pageUtil.setInvalid("#callingCodeInput",exist);pageUtil.refreshPage($scope);return}$scope.model.showAccountName="true"===data.identityUsed||$scope.model.accountName;btnGoEnroll=$("#goEnroll");btnCancelEnroll=$("#cancelEnroll");btnGoEnroll.unbind("click");btnCancelEnroll.unbind("click");$("#enrollPopBox").show();btnGoEnroll.bind("click",function(){var service,phoneNum,state,redirectUrl;onRemindLoginClick(0);service=getUrlParams().service;phoneNum="&phone="+$scope.model.phone;state="&state=registered";redirectUrl=service+phoneNum+state;window.location.href=redirectUrl;btnGoEnroll.unbind("click");btnCancelEnroll.unbind("click")});btnCancelEnroll.bind("click",function(){onRemindLoginClick(1);$("#enrollPopBox").hide();$scope.model.disableMsgBtn=!0;$("#smsInput").attr("btnDisabled","btnDisabled");$("#msgBtn").attr("disabled","disabled");callback&&callback()})}else{$scope.model.showAccountName="true"===data.identityUsed||$scope.model.accountName;$scope.model.disableMsgBtn=!0;$("#smsInput").attr("btnDisabled","btnDisabled");$("#msgBtn").attr("disabled","disabled");callback&&callback()}return}if("true"===data.canUse){exist=!1;$scope.model.showAccountName="true"===data.identityUsed;$("#msgBtn").addClass("msgBtnRed");$("#smsInput").removeClass("inputBeforeBtn");!isSubmit&&onPhoneCloudBi()}else{exist=!0;$scope.model.canPhoneUse=!1;$("#msgBtn").removeClass("msgBtnRed");$("#smsInput").addClass("inputBeforeBtn");!isSubmit&&onPhoneCloudBi(2)}}else exist=!1;pageUtil.setInvalid("#phoneInput",exist);pageUtil.setInvalid("#callingCodeInput",exist);if(data&&data.reason&&"PHONE_NOT_IN_WHITE_LIST"===data.reason){$scope.model.canPhoneUse=!1;$scope.model.showNotInWhiteList=!0}pageUtil.refreshPage($scope)},function(err){var msgMap,error_code,msg;exist=!1;msgMap={"CBC.7239":i18n("emailValid"),"CBC.7250":i18n("mobileValid")};error_code=err&&err.responseJSON&&err.responseJSON.error_code;msg=msgMap[error_code];msg&&$scope.showMessage(msgMap[error_code]);if($.inArray(error_code,["CBC.7250"])>-1){exist=!0;!isSubmit&&onPhoneCloudBi(2)}else!isSubmit&&onPhoneCloudBi();if(!exist&&1==isSubmit&&$scope.model.isMkRegister){$scope.model.disableMsgBtn=!0;$("#smsInput").attr("btnDisabled","btnDisabled");$("#msgBtn").attr("disabled","disabled");callback&&callback()}if(!exist){$("#msgBtn").addClass("msgBtnRed");$("#smsInput").removeClass("inputBeforeBtn")}pageUtil.setInvalid("#phoneInput",exist);pageUtil.setInvalid("#callingCodeInput",exist);pageUtil.refreshPage($scope)},!0)},"checkIdentity":function($scope,idType,idValue,callback_success,callback_fail){checkIdentity($scope,idType,idValue,callback_success,callback_fail,!0)},"queryBpRealName":function($scope){iamHttpService.get({"url":"/registerui/rest/cbc/cbccustmgrservice/v1/customer/customer-basic-info/"+$scope.bp.bpName,"async":!1}).then(function(data){$scope.bp.showName=data.name})},"queryConfigItem":function(appName,resourceId,attributeId,defaultValue){return window.regSysConfig&&window.regSysConfig[attributeId]||defaultValue},"queryRegConfigItem":function(resourceId,attributeId,defaultValue){return this.queryConfigItem("",resourceId,attributeId,defaultValue)},"sendVerifyCode":function($scope,callback_success,callback_fail){var sendCodeType,sendType,regionId,sessionId;window.hwcap&&window.hwcap.reload();sendCodeType=$scope.sendCodeType||GData.CONST.CODE_TYPE_SMS;sendType=$scope.isPhoneVerify?sendCodeType:GData.CONST.CODE_TYPE_EMAIL;regionId=$scope.model.regionId||GData.CONFIG.DEFAULT_REGION;sessionId=$scope.model.sessionId;void 0!==sessionId&&sessionId||(sessionId=(new Date).getTime());iamHttpService.post({"url":"/registerui/rest/cbc/cbccustomerregservice/v1/util/send_verify_code","async":!1,"contentType":"application/json; charset=utf-8","dataType":"json","params":JSON.stringify({"sessionId":sessionId,"type":sendType,"countryCode":$scope.model.callingCode,"mobilePhone":parsePhoneNumber(regionId,$scope.model.phone),"email":$scope.model.email,"captchaType":$scope.model.captchaType,"graphicCode":$scope.model.gcode,"scenceType":$scope.model.sceneType,"accountType":$scope.model.accountType,"areaCode":regionId,"geeTestVerifyInfo":$scope.model.captchaType!==GData.CONST.BOT_CHECK_TYPE_GEETEST?void 0:{"geetestChallenge":$scope.model.geetestChallenge,"geetestValidate":$scope.model.geetestValidate,"geetestSeccode":$scope.model.geetestSeccode},"clientInfo":{"devId":cookieOp.get_cookie("cbc-sid"),"hwMeta":$("#hwmeta").val()||""}}),"headers":{"X-Language":window.language}}).then(function(data){$(".vbox").hide();onGeetestCloudBi(data.error_code);$scope.model.needTimer=!0;callback_success&&callback_success(data)},function(err){var msgMap={"CBC.7241":i18n("GeetestVerifyCodeFailed"),"CBC.7248":i18n("GrapVerifyCodeFailed"),"CBC.7243":i18n("verifyCode.sendFailed"),"CBC.7196":i18n("sendVCIpBlackList"),"CBC.7197":i18n("sendVCIpFrequencyLimit"),"CBC.7198":i18n("sendVCDeviceLimit"),"CBC.7199":i18n("sendVCIpBlackList"),"CBC.7239":i18n("emailValid"),"CBC.7250":i18n("mobileValid"),"CBC.7184":i18n("verifyCode.emailExist"),"CBC.7185":i18n("registerFailed.mobileRepeat"),"CBC.7209":i18n("registerFailed.mobileOverLimit"),"CBC.0303":i18n("CBC.0303")},error_code=err&&err.responseJSON&&err.responseJSON.error_code;onGeetestCloudBi(error_code);$scope.showMessage(msgMap[error_code]||i18n("verifyCode.sendFailed"));if($.inArray(error_code,["CBC.7184","CBC.7239"])>-1)pageUtil.setInvalid("#emailInput",!0);else if($.inArray(error_code,["CBC.7185","CBC.7250","CBC.7209"])>-1){pageUtil.setInvalid("#phoneInput",!0);pageUtil.setInvalid("#callingCodeInput",!0)}callback_fail&&callback_fail(err)})},"portal_register":function($scope,callback_success,callback_fail){var uorExtParams,isMobile,mobile,regUrl,customerType;window.hwcap&&window.hwcap.reload();uorExtParams=$scope.model.buildUorExtParams();isMobile=$scope.model.clientType===GData.CONST.GT_CLIENT_TYPE_MOBILE;mobile=parsePhoneNumber($scope.model.regionId,$scope.model.verifyType===GData.CONST.VERIFY_TYPE_PHONE?$scope.model.phone:void 0);regUrl="/registerui/rest/cbc/cbccustomerregservice/v1/account/portal_register";$scope&&$scope.isUniRegister&&(regUrl="/registerui/rest/cbc/cbccustomerregservice/v1/account/uni_register");customerType=null;"indCustomer"===$scope.model.radioSelectedId?customerType=0:"orgCustomer"===$scope.model.radioSelectedId&&(customerType=1);iamHttpService.post({"url":regUrl,"contentType":"application/json; charset=utf-8","dataType":"json","params":JSON.stringify({"domainNameCreateMode":$scope.model.showAccountName?GData.CONST.CREATE_NAME_BY_CLIENT:GData.CONST.CREATE_NAME_BY_BACKEND,"domainName":trimInput($scope.model.accountName),"password":$scope.model.password,"pwdLevel":getPwdStrengthLevel($scope.model.password),"email":trimInput($scope.model.email),"mobilePhone":mobile,"countryCode":$scope.model.verifyType===GData.CONST.VERIFY_TYPE_PHONE?$scope.model.callingCode:void 0,"fromUser":getUrlParams().fromuser,"referrerAlias":getFromacct(cookieOp),"chanelId":getChannelFromVal(cookieOp),"authenticode":$scope.model.verifyType===GData.CONST.VERIFY_TYPE_TICKET?getUrlParams().ticket:trimInput($scope.model.verifyCode),"authenticodeType":$scope.model.verifyType,"clientInfo":{"devId":cookieOp.get_cookie("cbc-sid"),"hwMeta":$("#hwmeta").val()||""},"areaCode":$scope.model.regionId,"extParams":$scope.model.extParams,"allowNotify":GData.CONFIG.SHOW_MARKET_NOTICE?$scope.model.allowNotify:GData.CONFIG.MARKET_NOTICE_DEFAULT_CHECKED,"customerType":customerType}),"headers":{"X-Language":window.language}}).then(function(data){var nextUrl,phone,redirectUrl,uctrackid;onSubmitStep1(200,data.domainId,data.expireTime,"",uorExtParams);if($scope.bp.isBindBp)nextUrl=$scope.url.auto_login+"?idp="+GData.CONFIG.IDP+"&service="+encodeURIComponent($scope.bindBpUrl)+"&ticket="+data.autoLoginTicket;else{phone="+"+$scope.model.callingCode.substr(2)+" "+maskMobile($scope.model.phone);sessionStorage.setItem("accountInfoName",$scope.model.showAccountName?$scope.model.accountName:data.domainName);sessionStorage.setItem("accountInfoDomainId",data.domainId);$scope.model.regionJson&&sessionStorage.setItem("accountInfoRegion",$scope.model.regionJson[$scope.model.regionId]);sessionStorage.setItem("accountInfoPhone",phone);sessionStorage.setItem("uorExtParams",$scope.model.buildUorExtParams());$scope.model.email&&sessionStorage.setItem("accountInfoEmail",maskEmail($scope.model.email));nextUrl="/registerui/"+GData.CONFIG.SITE+(isMobile?"/m":"")+"/regsuc.html?locale="+window.language+"&ticket="+data.autoLoginTicket;redirectUrl=getUrlParams().service||$scope.url.home_page;if($scope.model.isMkRegister){redirectUrl+="&phone="+$scope.model.phone;redirectUrl+="&state=sucess";redirectUrl+="&id="+data.domainId;nextUrl+="&sence=mk"}uctrackid=getUrlParams().uctrackid;uctrackid&&(nextUrl+="&uctrackid="+uctrackid);$scope&&$scope.isUniRegister&&(nextUrl+="&uniRegister=true");nextUrl+="&service="+encodeURIComponent(redirectUrl)}setTimeout(function(){window.location.href=nextUrl},100);sessionStorage.removeItem("next_step");sessionStorage.removeItem("next_contact");callback_success&&callback_success(data)},function(err){var msgMap,error_code=err&&err.responseJSON&&err.responseJSON.error_code,http_code=err&&err.status&&parseInt(err.status);onSubmitStep1(error_code,err.domainId,err.expireTime,"",uorExtParams);if(3===$scope.model.verifyType&&"CBC.7151"===error_code&&"ticket expired"===err.responseJSON.error_msg){sessionStorage.removeItem("next_contact");sessionStorage.setItem("contactNum",$scope.model.contactNum);$scope.nextStep2();return}msgMap={"CBC.0100":i18n("input.invalid"),"CBC.7196":i18n("ipBlackList"),"CBC.7197":i18n("ipFrequencyLimit"),"CBC.7198":i18n("deviceLimit"),"CBC.7199":i18n("ipBlackList"),"CBC.7239":i18n("emailValid"),"CBC.7250":i18n("mobileValid"),"CBC.7151":i18n("verifyCode.invalid"),"CBC.7152":i18n("verifyCode.error"),"CBC.7156":i18n("verifyCode.usernameRepeat"),"CBC.7184":i18n("verifyCode.emailExist"),"CBC.7185":i18n("verifyCode.phoneExist"),"CBC.7228":i18n("pwdWeak"),"CBC.7357":i18n("registerFailed.mobileNotInWhiteList"),"CBC.7209":i18n("verifyCode.phoneOverLimit")};!http_code||"429"!==http_code&&429!==http_code?503==http_code?$scope.showMessage(i18n(error_code&&i18n(error_code)?error_code:"registerFailed")):$scope.showMessage(msgMap[error_code]||i18n("registerFailed")):$scope.showMessage(i18n("registerFailed.flowControled"));if("CBC.7152"===error_code)pageUtil.setInvalid("#smsInput",!0);else if("CBC.7156"===error_code)pageUtil.setInvalid("#accountInput",!0);else if("CBC.7184"===error_code)pageUtil.setInvalid("#emailInput",!0);else if("CBC.7185"===error_code||"CBC.7209"===error_code){pageUtil.setInvalid("#phoneInput",!0);pageUtil.setInvalid("#callingCodeInput",!0)}$.inArray(error_code,["CBC.0100","CBC.7152","CBC.7196","CBC.7197","CBC.7198","CBC.7199","CBC.7239","CBC.7250"])>-1?$scope.model.needTimer=!0:$scope.model.needTimer=!1;callback_fail&&callback_fail(err)})},"checkTicket":function($scope){window.hwcap&&window.hwcap.reload();iamHttpService.get({"url":"/registerui/rest/cbc/cbccustomerregservice/v1/customer/serviceValidate","contentType":"application/json; charset=utf-8","data":{"ticketType":"invi_reg_for_conf","ticket":getUrlParams().ticket},"async":!1}).then(function(data){sessionStorage.setItem("callingCodeShowValue",$scope.model.callingCodeShowValue);sessionStorage.setItem("callingCode",$scope.model.callingCode);$("#step1").hide();$("#step2").hide();$("#contactNum").show()},function(err){sessionStorage.setItem("next_step",!0);sessionStorage.removeItem("next_contact");$("#step1").hide();$("#step2").show();$("#contactNum").hide();onNextStep(200,$scope.model.buildUorExtParams())})},"queryHcsoSiteCode":function(){var result={};iamHttpService.get({"url":"/registerui/rest/cbc/cbccustmgrservice/v1/site/domain_site_mapping","contentType":"application/json; charset=utf-8","async":!1,"dataType":"json","params":{"domain":window.location.host}}).then(function(data){var mappingArr=data&&data.mappings?data.mappings:"";if(mappingArr.length>0){result.externalSiteCode=mappingArr[0].siteCode;result.iamDomain=mappingArr[0].iamDomain;result.hcsoLoginUrl="https://"+mappingArr[0].iamDomain+"/authui/login.action?locale="+window.language+(getUrlParams().service?"&service="+encodeURIComponent(getUrlParams().service):"")+"#/login"}},function(err){});return result}}});