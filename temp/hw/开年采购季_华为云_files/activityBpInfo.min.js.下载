function setAbiCookie(key, value) { var date = new Date(); date.setTime(date.getTime() + 30 * 60 * 1000); document.cookie = key + "=" + value + ";path=/;domain=.huaweicloud.com;expires=" + date.toGMTString() } function ruleBpName(value) { var reg = /^[A-Za-z0-9]+$/; if (!reg.test(value)) { return false } return true } function ruleBindType(value) { var reg = /^\d+$/; if (!reg.test(value)) { return false } return true } function parseParams() { var baseUrl = window.location.origin + window.location.pathname; var paramsStr = window.location.search; if (paramsStr.substr(0, 1) == '?') { paramsStr = paramsStr.substr(1) } if (null != paramsStr) { var params = paramsStr.split('&'); for (i = 0; i < params.length; i++) { var param = params[i].split('='); if (param.length > 1 && 'bpName' == param[0] && ruleBpName(param[1])) { var bpName = param[1] } if (param.length > 1 && 'bindType' == param[0] && ruleBindType(param[1])) { var bindType = param[1] } if (param.length > 1 && 'salesID' == param[0]) { var sid = param[1] } if (param.length > 1 && 'campaignID' == param[0]) { var campaignID = param[1] } } if (bpName && bindType) { var key = "hw_abi"; if (sid) { var value = '{"n":"' + bpName + '","t":' + bindType + ',"url":"' + baseUrl + '","sid":"' + sid + '","campaignID":"' + campaignID + '"}' } else { var value = '{"n":"' + bpName + '","t":' + bindType + ',"url":"' + baseUrl + '","campaignID":"' + campaignID + '"}' } setAbiCookie(key, value) } } } parseParams();