define(["language/resource"],function(i18n){"use strict";function trimSpace(inputId){$("#"+inputId).widget().option("value",getTrimValue(inputId))}function getTrimValue(inputId){var value,inputField=$("#"+inputId).widget();value=inputField?$.trim(inputField.getValue()):"";return value.replace(/\s+/g,function(match,capture){return" "})}function getUrlParams(){var index,key,value,urlParams={},searchStr=window.location.search.substring(1),params=searchStr.split("&");for(index=0;index<params.length;index++){key=params[index].substring(0,params[index].indexOf("="));value=params[index].substring(params[index].indexOf("=")+1);urlParams[key]=decodeURIComponent(value)}return urlParams}function i18nFormat(){var regex,args;if(1===arguments.length)return arguments[0];regex=/{\d+}/g;args=arguments;return args[0].replace(regex,function(m,i){var index=parseInt(m.substr(1,m.length-1))+1;return void 0!=args[index]?args[index]:m})}function getPwdStrengthLevel(pwd){function charMode(iN){if(iN>=48&&iN<=57)return 1;if(iN>=65&&iN<=90)return 2;return iN>=97&&iN<=122?4:8}function bitTotal(num){var k,modes1=0;for(k=0;k<4;k++){1&num&&modes1++;num>>>=1}return modes1}function getLevel(allBits){switch(allBits){case 4:case 3:return"high";case 2:return"mid";case 1:default:return"low"}}var i,modes=0;for(i=0;i<pwd.length;i++)modes|=charMode(pwd.charCodeAt(i));return getLevel(bitTotal(modes))}function pwdLevel4Display(lowId,midId,highId){return{"params":[lowId,midId,highId],"validFn":function(params){var low,mid,high,level,defaultColor="#dcdcdc",midColor="#ff6a00",highColor="#0a9e00",pwd=this.val();if(null==pwd||""==pwd){low=defaultColor;mid=defaultColor;high=defaultColor;switchClazz("")}else{level=pwd.length<6?"low":getPwdStrengthLevel(pwd);switch(level){case"high":low=highColor;mid=highColor;high=highColor;switchClazz("high");break;case"low":low="#ff460f";mid=defaultColor;high=defaultColor;switchClazz("low");break;case"mid":low=midColor;mid=midColor;high=defaultColor;switchClazz("mid");break;default:low=defaultColor;mid=defaultColor;high=defaultColor;switchClazz("")}}$("#"+params[0])[0].style.background=low;$("#"+params[1])[0].style.background=mid;$("#"+params[2])[0].style.background=high;return!0}}}function switchClazz(clazz){try{$("#TIP").removeClass("high");$("#TIP").removeClass("low");$("#TIP").removeClass("mid");$("#TIP").addClass(clazz)}catch(e){}}function clearPwdDisplayLevel(lowId,midId,highId){$("#"+lowId)[0].style.backgroundColor="#D0D0D0";$("#"+midId)[0].style.backgroundColor="#D0D0D0";$("#"+highId)[0].style.backgroundColor="#D0D0D0";switchClazz("")}function setPwdLevel(lowId,midId,highId,pwd,pwdLvlColors){var level="";level=null==pwd||""==pwd?"":pwd.length<6?"low":getPwdStrengthLevel(pwd);setPwdLevelByLevel(lowId,midId,highId,level,pwdLvlColors)}function setPwdLevelByLevel(lowId,midId,highId,level,pwdLvlColors){var low,mid,high,defaultColor="#dcdcdc",lowColor="#ff460f",midColor="#ff6a00",highColor="#0a9e00";if(pwdLvlColors&&pwdLvlColors.length>=4){defaultColor=pwdLvlColors[0];lowColor=pwdLvlColors[1];midColor=pwdLvlColors[2];highColor=pwdLvlColors[3]}switch(level){case"high":low=highColor;mid=highColor;high=highColor;switchClazz("high");break;case"low":low=lowColor;mid=defaultColor;high=defaultColor;switchClazz("low");break;case"mid":low=midColor;mid=midColor;high=defaultColor;switchClazz("mid");break;default:low=defaultColor;mid=defaultColor;high=defaultColor;switchClazz("")}if(0!=$("#"+lowId).size()){$("#"+lowId)[0].style.background=low;$("#"+midId)[0].style.background=mid;$("#"+highId)[0].style.background=high}}function getEmailURL(emailURL){var domainURLs={"yeah.net":"http://www.yeah.net/","sogou.com":"http://mail.sogou.com/","188.com":"http://www.188.com/index.htm?from=h2","x263.net":"http://mail.263.net/","263.net.cn":"http://mail.263.net/","263.net":"http://mail.263.net/","21cn.com":"http://mail.21cn.com/","eyou.com":"http://www.eyou.com/","yahoo.com":"http://cn.mail.yahoo.com/","yahoo.com.cn":"http://cn.mail.yahoo.com/","yahoo.cn":"http://cn.mail.yahoo.com/","foxmail.com":"http://mail.qq.com/","qq.com":"http://mail.qq.com/","LIVE.COM":"http://www.hotmail.com/","LIVE.CN":"http://www.hotmail.com/","hotmail.com":"http://www.hotmail.com/","gmail.com":"http://mail.google.com/","139.com":"http://mail.139.com/","126.com":"http://www.126.com/","tom.com":"http://mail.tom.com/","vip.tom.com":"http://mail.tom.com/","163.net":"http://mail.tom.com/","sohu.com":"http://login.mail.sohu.com/","sina.com":"http://mail.sina.com.cn/","sina.cn":"http://mail.sina.com.cn/","2008.sina.com":"http://mail.sina.com.cn/","163.com":"http://mail.163.com/","huawei.com":"http://imail.huawei.com/"},domain=emailURL.split("@")[1];if(domain in domainURLs)return domainURLs[domain];return""}function getMessageInstance(width,i18n){return{"ERROR":getHandlerByType("error",width,i18n),"PROMPT":getHandlerByType("prompt",width,i18n),"CONFIRM":getHandlerByType("confirm",width,i18n),"WARN":getHandlerByType("warn",width,i18n)}}function getMobileMessageInstance(width,i18n){return{"ERROR":getMobileHandlerByType("error",width,i18n),"PROMPT":getMobileHandlerByType("prompt",width,i18n),"CONFIRM":getMobileHandlerByType("confirm",width,i18n),"WARN":getMobileHandlerByType("warn",width,i18n)}}function getMobileHandlerByType(type,width,i18n){return function(content,detail,id,buttons,closeCallback){createTipDiv(content);$("#TipDiv").show();setTimeout(function(){$("#TipDiv").remove();closeCallback&&closeCallback()},2e3)}}function createTipDiv(tipInfo){var tipDiv='<p id="TipDiv" style="background: rgba(0, 0, 0, 0.8);text-align: center;padding:10px 10px;color: #fff;z-index: 9999;position: absolute;margin-left: 4%;top: 40%;-webkit-border-radius: 2px;width: 92%;font-size: 16px;">'+tipInfo+"</p>";$("#TipDiv").remove();$(document.body).append(tipDiv)}function createPopTipDiv(){var tipDiv='<div id="popLayer" style="display: block;background-color: #B3B3B3;position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 10;-moz-opacity: 0.8;opacity:.80;filter: alpha(opacity=80);"></div><div id="popBox" style="display: block;background-color: #FFFFFF;position: fixed;z-index: 11;width: 80%;overflow: hidden;border-radius: 10px;right:0;left: 0;margin:auto;"><div id="phoneRegisted" style="text-align: center;max-height: 100px;line-height: 71px;font-size: 14px;color: #222222;letter-spacing: 0;">'+i18n("registerSuccess.phoneRegisted")+'</div><div style="border: 0.5px solid #A0A2A8;"></div><div id="below" style="height: 45px;"><div id="enroll" style="float: left;text-align: center;width: 50%;color: red;line-height:45px;font-size: 16px;color: #FF4C4C;letter-spacing: 0;">'+i18n("registerSuccess.redirect2Mk")+'</div><div style="float: left;width: 1px;height: 100%;background: #A0A2A8;"></div><div id="cancelEnroll" style="float: left;text-align: center;width: 49.5%;font-size: 16px;color: #BBBBBB;letter-spacing: 0;line-height: 45px;">'+i18n("registerSuccess.cancel")+"</div></div></div>";$("#popLayer").remove();$("#popBox").remove();$(document.body).append(tipDiv)}function getHandlerByType(type,width,i18n){return function(content,detail,id,buttons,closeCallback){var btns,index,options={"type":type,"content":content,"detail-msg":detail,"width":width,"append-to":"#"+id,"buttons":[]},msg=new tinyWidget.Message(options);if(void 0===buttons||0===buttons.length){btns=[{"key":"btnId2","label":i18n("btnTxtOK"),"focused":!1,"handler":function(event){msg.destroy()}}];msg.option("buttons",btns)}else{msg.buttonHandlers={};for(index=0;index<buttons.length;index++){msg.buttonHandlers[buttons[index].label]=buttons[index].handler;buttons[index].handler=function(event){var originalHandler=msg.buttonHandlers[event.value];msg.destroy();originalHandler&&originalHandler()}}msg.option("buttons",buttons)}closeCallback&&msg.on("close",closeCallback);msg.show()}}function getSecurityMasker(){return{"maskMobile":function(mobile){-1!==mobile.indexOf("-")&&(mobile=mobile.substring(mobile.indexOf("-")+1));if(""===mobile||void 0===mobile)return"";if(mobile.length>7)return mobile.substr(0,3)+"****"+mobile.substr(7,mobile.length);if(mobile.length>3)return mobile.substr(0,3)+"****";return mobile+"****"},"maskEmail":function(email){var pair,pref,len,beginString,endString,maskEmail;if(!email)return"******";if(-1===email.indexOf("@"))return"******";pair=email.split("@");if(2!==pair.length)return"******";pref=pair[0];len=pref.length;beginString=len<2?pref:pref.substring(0,1);endString=len>2?pref.substring(len-1,len):"";maskEmail="";2===len||3===len?maskEmail="*":4===len?maskEmail="**":len>4&&(maskEmail="***");return beginString+maskEmail+endString+"@"+pair[1]}}}function SortArray(sortStr){return function(a,b){a=a[sortStr];a=a.substring(a.indexOf("(")+1,a.indexOf(")"));b=b[sortStr];b=b.substring(b.indexOf("(")+1,b.indexOf(")"));return a.localeCompare(b)}}function getCodeValue(codeObj,value){var codeValue,item;for(item in codeObj)codeObj[item]===value&&(codeValue=item);return codeValue}function getCountryValue(codeObj,value){var countryValue,item;for(item in codeObj)item===value&&(countryValue=codeObj[item]);return countryValue}function getPhoneRegex(countryCode,regexJson){if(!regexJson)return"";return regexJson[countryCode]}function getRegionValue(codeObj,value){var regionValue,item;for(item in codeObj)codeObj[item]===value.trim()&&(regionValue=item);return regionValue}function getPubPhoneLen(codeObj,phoneLenObj){if(!phoneLenObj)return 32;var countryCode=getCodeValue(codeObj,$scope.model.phone);if(getPhoneRegex(countryCode,phoneLenObj))return getPhoneRegex(countryCode,phoneLenObj);return 32}function UTCtoLocal(UTCTime,format){function getTimeString(date){function normalize(str){return str.length<2?"0"+str:str}var time=normalize(String(date.getHours()))+":"+normalize(String(date.getMinutes()))+":"+normalize(String(date.getSeconds()));if("dd-mm-yyyy hh:mm:ss"===format.toLowerCase())return normalize(String(date.getDate()))+"-"+normalize(String(date.getMonth()+1))+"-"+date.getFullYear()+" "+time;if("mm-dd-yyyy hh:mm:ss"===format.toLowerCase())return normalize(String(date.getMonth()+1))+"-"+normalize(String(date.getDate()))+"-"+date.getFullYear()+" "+time;return date.getFullYear()+"-"+normalize(String(date.getMonth()+1))+"-"+normalize(String(date.getDate()))+" "+time}function getTzOffsets(){var i,d,newOffset,DST,nonDST,arr=[];for(i=0;i<365;i++){d=new Date;d.setDate(i);newOffset=d.getTimezoneOffset();arr.push(newOffset)}DST=Math.min.apply(null,arr);nonDST=Math.max.apply(null,arr);return[DST,nonDST]}var tzOffset,utcTime=new Date(UTCTime.replace(/-/g,"/")),localTime=new Date(utcTime.getTime()-1e3*utcTime.getTimezoneOffset()*60);void 0===tzOffsets&&(tzOffsets=getTzOffsets());if(tzOffsets[0]!==tzOffsets[1]){tzOffset=localTime.getTimezoneOffset();if(tzOffset===tzOffsets[0])return getTimeString(localTime)+" DST"}return getTimeString(localTime)}function getCurrentTimeZone(){var minutes=(new Date).getTimezoneOffset(),hour=parseInt(minutes/60,10),munite=minutes%60,prefix="-";if(hour<0||munite<0){prefix="+";hour=-hour;munite<0&&(munite=-munite)}hour=String(hour);munite=String(munite);1===hour.length&&(hour="0"+hour);1===munite.length&&(munite="0"+munite);return"GMT"+prefix+hour+":"+munite}function getAuthenticationUrl(url,authenUrl){var params,index,key,value,searchParam="";-1!==url.indexOf("?")&&-1!==url.indexOf("service")&&(searchParam=url.substring(url.indexOf("?")+1));if(!searchParam){url=url+"&service="+encodeURIComponent(authenUrl);return url}params=searchParam.split("&");for(index=0;index<params.length;index++){key=params[index].substring(0,params[index].indexOf("="));value=params[index].substring(params[index].indexOf("=")+1);if("service"===key){url=url.replace(value,encodeURIComponent(authenUrl));return url}}return url}function validateCharNum(value,contSameCharLen){var num,finalNum,char,i;if(0==contSameCharLen)return!0;num=1;finalNum=1;char=value.charAt(0);for(i=1;i<value.length;i++)if(char==value.charAt(i)){num++;finalNum=num>=finalNum?num:finalNum}else{char=value.charAt(i);num=1}return finalNum<=contSameCharLen}function validatePasswdChar(value){if(new RegExp("[一-龥]+").test(value))return!1;if("high"!==getPwdStrengthLevel(value)&&"mid"!==getPwdStrengthLevel(value))return!1;return!0}function buildPasswordTip(number,chars,maxSameChars,notEqualName,notContsMobile,i18n,notBeginAndEndBlank){var tip="<div style='font-size:12px;font-family:Arial;color:#050505;margin: 5px 0 5px 10px;'><img id='minLenId' class='tootip-img' src='//res.hc-cdn.com/register/6.2.209/registerui/theme/image/default.png'></img>&nbsp;&nbsp;<div class='tootip-div'>"+number+"</div><img id='containsCharsId' class='tootip-img' src='//res.hc-cdn.com/register/6.2.209/registerui/theme/image/default.png'></img>&nbsp;&nbsp;<div class='tootip-div'>"+chars+"</div>";maxSameChars&&(tip=tip+"<img id='maxSameCharsId' class='tootip-img' src='//res.hc-cdn.com/register/6.2.209/registerui/theme/image/default.png'></img>&nbsp;&nbsp;<div id='maxSameCharsLabel' class='tootip-div'>"+maxSameChars+"</div>");notEqualName&&(tip=tip+"<img id='notNameId' class='tootip-img' src='//res.hc-cdn.com/register/6.2.209/registerui/theme/image/default.png'></img>&nbsp;&nbsp;<div class='tootip-div'>"+notEqualName+"</div>");notContsMobile&&(tip=tip+"<img id='notContsId' class='tootip-img' src='//res.hc-cdn.com/register/6.2.209/registerui/theme/image/default.png'></img>&nbsp;&nbsp;<div class='tootip-div'>"+notContsMobile+"</div>");notBeginAndEndBlank&&(tip=tip+"<img id='notBeginAndEndBlankId' class='tootip-img' src='//res.hc-cdn.com/register/6.2.209/registerui/theme/image/default.png'></img>&nbsp;&nbsp;<div class='tootip-div'>"+notBeginAndEndBlank+"</div>");tip=tip+"<div ><div  style='display:inline-block;margin-left:-22px'><span style='float:right' id='strengthflag'></span><span id='strengthHigh' class='passwordStrength'></span><span id='strengthMid' class='passwordStrength'></span><span id='strengthLow'  class='passwordStrength'></span><span style='display: inline-block;float:left;margin-left:27px;'>"+i18n("safetyDegree")+"</span></div></div></div>";return tip}function getInputObj(id){var inputObj=$("#"+id);"INPUT"!==inputObj[0].tagName&&(inputObj=$("#"+id+" input"));return inputObj}function createRemindLoginDiv(mobile){var tipDiv='<div id="popLayer" style="display: block;background-color: #B3B3B3;position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 10;-moz-opacity: 0.8;opacity:.80;filter: alpha(opacity=80);"></div><div id="popBox" style="display: block;background-color: #FFFFFF;position: fixed;z-index: 11;width: 80%;height: 139px;overflow: hidden;border-radius: 10px;top: 0;right:0;left: 0;bottom:30%;margin:auto;"><div id="phoneRegisted" style="display: -webkit-box; -webkit-box-pack: center;-webkit-box-align: center;-webkit-box-orient: vertical;height: 95px;text-align: center;line-height: 33px;font-size: 14px;color: #222222;letter-spacing: 0;"><span>'+i18n("registerSuccess.phoneRegisted1")+mobile+i18n("registerSuccess.phoneRegisted2")+'</span><br/><span style="font-size: 17px;font-weight: 600;">'+i18n("registerSuccess.isLogin")+'</span></div><div style="border: 0.5px solid #A0A2A8;"></div><div id="below" style="height: 45px;"><div id="goOnRegister" style="float: left;text-align: center;width: 50%;line-height:45px;font-size: 16px;color: #BBBBBB;letter-spacing: 0;">'+i18n("registerSuccess.goOnRegister")+'</div><div style="float: left;width: 1px;height: 100%;background: #A0A2A8;"></div><div id="loginNow" style="float: left;text-align: center;width: 49.5%;font-size: 16px;color: #FF4C4C;letter-spacing: 0;line-height: 45px;">'+i18n("registerSuccess.loginNow")+"</div></div></div>";$("#popLayer").remove();$("#popBox").remove();$(document.body).append(tipDiv)}var tzOffsets;return{"i18nFormat":i18nFormat,"trimSpace":trimSpace,"getTrimValue":getTrimValue,"getUrlParams":getUrlParams,"getPwdStrengthLevel":getPwdStrengthLevel,"pwdLevel4Display":pwdLevel4Display,"clearPwdDisplayLevel":clearPwdDisplayLevel,"getEmailURL":getEmailURL,"getMessageInstance":getMessageInstance,"getMobileMessageInstance":getMobileMessageInstance,"getSecurityMasker":getSecurityMasker,"SortArray":SortArray,"getCodeValue":getCodeValue,"getCountryValue":getCountryValue,"UTCtoLocal":UTCtoLocal,"setPwdLevel":setPwdLevel,"setPwdLevelByLevel":setPwdLevelByLevel,"getPhoneRegex":getPhoneRegex,"getRegionValue":getRegionValue,"getPubPhoneLen":getPubPhoneLen,"EmailRegex":/^((([A-Za-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([A-Za-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([A-Za-z]|\d|-|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([A-Za-z]|\d|-|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/,"getCurrentTimeZone":getCurrentTimeZone,"validateCharNum":validateCharNum,"validatePasswdChar":validatePasswdChar,"buildPasswordTip":buildPasswordTip,"getInputObj":getInputObj,"getAuthenticationUrl":getAuthenticationUrl,"createTipDiv":createTipDiv,"createPopTipDiv":createPopTipDiv,"createRemindLoginDiv":createRemindLoginDiv}});