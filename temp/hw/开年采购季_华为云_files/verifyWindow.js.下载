define(["language/resource","base/utils/preVerifycodeUtil","base/utils/iamHttpService","base/utils/utility"],function(i18n,perVerifycodeUtil,iamHttpService,utils){function addCssToPage(href){var head=document.getElementsByTagName("head")[0],cssLink=document.createElement("link");cssLink.type="text/css";cssLink.rel="stylesheet";cssLink.href=href;head.appendChild(cssLink)}var index,ctrl;i18n=i18n;index=2;ctrl=["$scope","tiValid","tiModalInstance","items",function($scope,tiValid,tiModalInstance,items){function getVerifyCode(indexs){return"/registerui/verifycode?index="+indexs}function preValidCallback(){$scope.model.verifyCode="";$scope.$apply();var verifyCodeImg=$("#GrapVerifyCodeImg")[0];verifyCodeImg&&(verifyCodeImg.src=getVerifyCode(index))}var okCallbacks,cancleCallback,isMobile=!1,verifyHolder="";if(items){(items.isMobile||items.isMobileApp)&&(isMobile=!0);okCallbacks=items.okCallback;cancleCallback=items.cancleCallback}$scope.title=i18n("GraphicsVerifyCode");$scope.okBtn=i18n("btnTxtOK");$scope.cancleBtn=i18n("btnTxtCancel");if(1==isMobile){addCssToPage("//res.hc-cdn.com/register/6.2.209/registerui/theme/css/graphVerCode.css");verifyHolder=i18n("verifyCodePlaceHolder")}$scope.model={"inputId":"graph_verifyCode","focused":!0,"InputGrapVerifyCodeInfo":i18n("InputGrapVerifyCodeInfo"),"GraphicsVerifyCode":i18n("GraphicsVerifyCodeLabel"),"checkCodeTip":i18n("getVerifyCode"),"verifyCodeSrc":getVerifyCode(index),"verifyCode":"","tipPosition":"top","checkCodePH":"","isMobile":!1,"isMobileApp":!1,"verifyHolder":verifyHolder,"verifyCodeValidate":{"validator":[{"rule":function(value){if(void 0==value||0===value.length||-1!==value.toString().indexOf(" "))return i18n("blankTxt");return""}}],"position":"top-left"}};if(!0===isMobile){$scope.model.checkCodePH=i18n("m.verifyCodePlaceHolder");$scope.model.isMobile=!0}else $scope.style={"verifyCodeInfo":{"margin-top":"4%"},"verifyCodeContent":{"margin-top":"5%"}};$scope.model.msgKeyPress=function(event){if(13===event.keyCode){$("#btnOK").click();$scope.$apply()}};$scope.model.getVerifyCode=function(){$("#GrapVerifyCodeImg")[0].src=getVerifyCode(index);$scope.model.verifyCode="";$("#validresultImg").hide()};$scope.model.preValidVerifyCode=function(value){$("#"+$scope.model.inputId+" input").attr("maxLength",4);var img=$("#validresultImg");perVerifycodeUtil.preValidVerifyCode(img,value,index,preValidCallback,iamHttpService)};$scope.okClick=function(){if(!tiValid.check($("#graph_verifyCode")))return;okCallbacks($scope.model.verifyCode);tiModalInstance.close()};$scope.cancleClick=function(){cancleCallback();tiModalInstance.close()}}];return ctrl});